import{d as r,x as q,_ as G,K as U,L as i,M as l,m as t,R as d,V as g,O as n,S as a,T as B,F as J,U as Q,W as b,Z as O,Y as X,B as ee}from"./vue-vendor-B4qzxTjV.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as le,e as oe,g as ae,f as se}from"./index-CIpMSW_s.js";import{V as N,a as F,b as K,c as re}from"./VCard-BaakkVFD.js";import{h as ie,f as v}from"./VAvatar-C-ER2-0S.js";import{V as L}from"./VSpacer-CKNG9Jdn.js";import{V as R}from"./VChip-pvFqXEpf.js";import{V as m}from"./VBtn-B-hdhH-1.js";import{V as ne}from"./VRating-prAmFwNY.js";import{V as h}from"./VTextarea-8VdTHJP4.js";import{V as ue}from"./VForm-D0rJnxSg.js";import{V as de}from"./VDialog-BeAbm4-J.js";import{V as j}from"./VSelect-DqaGkUWA.js";import"./vuetify-vendor-BD37EBPT.js";import"./index-yNQZhi3p.js";import"./VField-BmVeynRq.js";import"./VInput-Bp3p24Ap.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-BXO8EOEs.js";import"./lazy-UP9naqc7.js";import"./dialog-transition-MjUo7Nu_.js";import"./VTextField-BhM9EnZB.js";import"./VList-zMJOwsiP.js";import"./VDivider-Drx-iRHJ.js";import"./VMenu-BWniRe4g.js";import"./VCheckboxBtn-CvAPjEFh.js";import"./VSelectionControl-b5nrjLPm.js";const me={key:0,class:"text-caption"},fe={key:1,class:"text-caption"},pe={key:2,class:"text-caption"},ve={key:0,class:"text-center my-8"},ce={key:1,class:"text-center my-6 py-3 rounded bg-grey-lighten-4"},Ve={class:"my-2"},xe={key:0,class:"pa-3 border-top"},ye={class:"d-flex align-center"},ge={key:1,class:"pa-3 border-top d-flex justify-center"},be={__name:"client",setup(we){const u=r(null),f=r([]),p=r(""),_=r(!1),x=r(null),w=r(!1),c=r(!1),k=r(0),T=r(""),C=r(!1),y=r(!1),D=r([]),z=r([]),M=r([{id:1,name:"Иванов Иван"},{id:2,name:"Петрова Мария"},{id:3,name:"Сидоров Алексей"},{id:4,name:"Козлова Екатерина"}]);function A(s){if(!s)return"";const e=new Date,o=new Date(s);return e.toDateString()===o.toDateString()?o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):o.toLocaleDateString()}function S(){if(!p.value.trim()||!u.value)return;const s={sender:"client",text:p.value.trim(),time:new Date};f.value.push(s),p.value="",V(),I()}async function V(){await ee(),x.value&&(x.value.scrollTop=x.value.scrollHeight)}function E(){w.value=!0,setTimeout(()=>{w.value=!1},2e3)}function I(){setTimeout(()=>{E(),setTimeout(()=>{const s=["Спасибо за обращение! Чем я могу вам помочь?","Я понимаю вашу проблему. Давайте решим ее вместе.","Минутку, я проверю информацию по вашему вопросу.","Могли бы вы предоставить дополнительные детали?","Спасибо за ожидание. Я нашел решение вашей проблемы."],e={sender:"operator",text:s[Math.floor(Math.random()*s.length)],time:new Date};f.value.push(e),V()},2e3)},1e3)}function P(){y.value=!1,alert("Ваши предпочтения сохранены")}function W(){C.value=!0,alert("Спасибо за ваш отзыв!")}function $(){c.value=!1,C.value=!1,k.value=0,T.value="",f.value=[],u.value=null,setTimeout(()=>{u.value={id:Math.floor(Math.random()*4)+1,name:M.value[Math.floor(Math.random()*4)].name,status:"в сети"},setTimeout(()=>{const s={sender:"operator",text:`Здравствуйте! Меня зовут ${u.value.name}. Чем я могу вам помочь сегодня?`,time:new Date};f.value.push(s),V()},1e3)},2e3)}function H(){c.value=!0,V()}function Y(){setTimeout(()=>{_.value=!0,setTimeout(()=>{u.value={id:2,name:"Петрова Мария",status:"в сети"},setTimeout(()=>{const s={sender:"operator",text:"Здравствуйте! Меня зовут Мария. Чем я могу вам помочь сегодня?",time:new Date};f.value.push(s),V()},1e3)},3e3),setTimeout(()=>{const s={sender:"operator",text:"Спасибо за обращение в нашу службу поддержки! Надеюсь, я смог помочь вам. Если у вас возникнут еще вопросы, не стесняйтесь обращаться снова.",time:new Date};f.value.push(s),setTimeout(()=>{H()},2e3)},3e5)},1e3)}return q(()=>{Y()}),G(()=>{}),(s,e)=>(i(),U(se,{fluid:"",class:"pa-0 fill-height"},{default:l(()=>[t(le,{"no-gutters":"",class:"fill-height"},{default:l(()=>[t(oe,{cols:"12"},{default:l(()=>[t(N,{flat:"",height:"100%",class:"d-flex flex-column"},{default:l(()=>[t(F,{class:"border-bottom d-flex align-center"},{default:l(()=>[t(ie,{color:"primary",size:"36",class:"mr-3"},{default:l(()=>[t(v,{color:"white"},{default:l(()=>e[7]||(e[7]=[a("mdi-headset")])),_:1})]),_:1}),n("div",null,[e[9]||(e[9]=n("div",{class:"text-body-1"},"Оператор поддержки",-1)),w.value?(i(),d("div",me,"печатает...")):u.value?(i(),d("div",fe,B(u.value.status),1)):(i(),d("div",pe,[t(ae,{indeterminate:"",size:"16",width:"2",color:"primary",class:"mr-2"}),e[8]||(e[8]=a(" Ожидание подключения оператора... "))]))]),t(L),_.value?(i(),U(R,{key:0,color:"success",size:"small"},{default:l(()=>e[10]||(e[10]=[a(" Подключено ")])),_:1})):(i(),U(R,{key:1,color:"error",size:"small"},{default:l(()=>e[11]||(e[11]=[a(" Отключено ")])),_:1})),t(m,{icon:"",class:"ml-2"},{default:l(()=>[t(v,null,{default:l(()=>e[12]||(e[12]=[a("mdi-dots-vertical")])),_:1})]),_:1})]),_:1}),t(K,{class:"flex-grow-1 overflow-auto pa-4",ref_key:"chatMessages",ref:x},{default:l(()=>[!u.value&&f.value.length===0?(i(),d("div",ve,[t(v,{size:"60",color:"grey lighten-1"},{default:l(()=>e[13]||(e[13]=[a("mdi-account-voice")])),_:1}),e[14]||(e[14]=n("div",{class:"text-h6 mt-4"},"Ожидание подключения оператора",-1)),e[15]||(e[15]=n("div",{class:"text-body-2 text-grey mt-2"},"Пожалуйста, подождите. Мы подключим вас к первому доступному оператору.",-1))])):g("",!0),(i(!0),d(J,null,Q(f.value,(o,Z)=>(i(),d("div",{key:Z,class:b(["mb-4",{"d-flex justify-end":o.sender==="client","d-flex justify-start":o.sender==="operator"}])},[n("div",{class:b(["message-bubble pa-3 rounded",{primary:o.sender==="client","bg-grey-lighten-3":o.sender==="operator"}]),style:{"max-width":"80%"}},[n("div",{class:b({"text-white":o.sender==="client"})},B(o.text),3),n("div",{class:b(["text-caption mt-1 text-right",{"text-white":o.sender==="client"}])},B(A(o.time)),3)],2)],2))),128)),c.value?(i(),d("div",ce,[e[17]||(e[17]=n("div",{class:"text-body-1"},"Сессия завершена",-1)),e[18]||(e[18]=n("div",{class:"text-body-2 text-grey mt-1"},"Оцените качество общения",-1)),n("div",Ve,[t(ne,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=o=>k.value=o),color:"amber","active-color":"amber",hover:"",length:"5"},null,8,["modelValue"])]),t(h,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=o=>T.value=o),label:"Ваши комментарии (необязательно)",rows:"2",variant:"outlined",density:"compact","hide-details":"",class:"mx-auto mt-3",style:{"max-width":"400px"}},null,8,["modelValue"]),t(m,{color:"primary",class:"mt-3",onClick:W},{default:l(()=>e[16]||(e[16]=[a(" Отправить отзыв ")])),_:1})])):g("",!0)]),_:1},512),c.value?g("",!0):(i(),d("div",xe,[t(ue,{onSubmit:O(S,["prevent"])},{default:l(()=>[n("div",ye,[t(m,{icon:"",class:"mr-2"},{default:l(()=>[t(v,null,{default:l(()=>e[19]||(e[19]=[a("mdi-emoticon-outline")])),_:1})]),_:1}),t(m,{icon:"",class:"mr-2"},{default:l(()=>[t(v,null,{default:l(()=>e[20]||(e[20]=[a("mdi-paperclip")])),_:1})]),_:1}),t(h,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=o=>p.value=o),placeholder:"Введите сообщение...",rows:"1","auto-grow":"","hide-details":"",density:"compact",class:"flex-grow-1",onKeydown:X(O(S,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),t(m,{icon:"",class:"ml-2",color:"primary",onClick:S,disabled:!p.value.trim()||!u.value},{default:l(()=>[t(v,null,{default:l(()=>e[21]||(e[21]=[a("mdi-send")])),_:1})]),_:1},8,["disabled"])])]),_:1})])),c.value&&C.value?(i(),d("div",ge,[t(m,{color:"primary",class:"mx-2",onClick:$},{default:l(()=>e[22]||(e[22]=[a(" Новый чат ")])),_:1}),t(m,{color:"secondary",class:"mx-2",to:"/client/profile"},{default:l(()=>e[23]||(e[23]=[a(" Вернуться в профиль ")])),_:1})])):g("",!0)]),_:1})]),_:1})]),_:1}),t(de,{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=o=>y.value=o),"max-width":"500"},{default:l(()=>[t(N,null,{default:l(()=>[t(F,null,{default:l(()=>e[24]||(e[24]=[a("Предпочтения общения")])),_:1}),t(K,null,{default:l(()=>[e[25]||(e[25]=n("p",{class:"mb-3"},"Вы можете указать предпочтительных операторов или тех, с кем бы не хотели общаться.",-1)),t(j,{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=o=>D.value=o),items:M.value,"item-title":"name","item-value":"id",label:"Предпочтительные операторы",multiple:"",chips:""},null,8,["modelValue","items"]),t(j,{modelValue:z.value,"onUpdate:modelValue":e[4]||(e[4]=o=>z.value=o),items:M.value.filter(o=>!D.value.includes(o.id)),"item-title":"name","item-value":"id",label:"Нежелательные операторы",multiple:"",chips:""},null,8,["modelValue","items"])]),_:1}),t(re,null,{default:l(()=>[t(L),t(m,{color:"primary",onClick:P},{default:l(()=>e[26]||(e[26]=[a("Сохранить")])),_:1}),t(m,{color:"secondary",onClick:e[5]||(e[5]=o=>y.value=!1)},{default:l(()=>e[27]||(e[27]=[a("Отмена")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},qe=te(be,[["__scopeId","data-v-e6ec3355"]]);export{qe as default};
