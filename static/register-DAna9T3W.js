import{f as B,Q as S,d as r,K as j,L as D,M as o,m as a,O as d,Z as E,S as u,T as N}from"./vue-vendor-B4qzxTjV.js";import{d as C,e as s,f as F}from"./index-CIpMSW_s.js";import{V as M,a as P,b as R,c as $}from"./VCard-BaakkVFD.js";import{V as z}from"./VForm-D0rJnxSg.js";import{V as m}from"./VTextField-BhM9EnZB.js";import{V as A}from"./VCheckbox-BrkgBynp.js";import{V as g}from"./VBtn-B-hdhH-1.js";import{V as I}from"./VDivider-Drx-iRHJ.js";import{V as K}from"./VSnackbar-X6915U30.js";import"./vuetify-vendor-BD37EBPT.js";import"./VAvatar-C-ER2-0S.js";import"./VInput-Bp3p24Ap.js";import"./index-yNQZhi3p.js";import"./forwardRefs-C-GTDzx5.js";import"./VField-BmVeynRq.js";import"./VCheckboxBtn-CvAPjEFh.js";import"./VSelectionControl-b5nrjLPm.js";import"./VOverlay-BXO8EOEs.js";import"./lazy-UP9naqc7.js";const ne={__name:"register",setup(L){const T=B("auth"),U=S(),x=r(null),v=r(""),V=r(""),c=r(""),p=r(""),k=r(""),n=r(!1),w=r(!1),b=r(!1),i=r(!1),f=r(""),y=r("error"),q=async()=>{if(x.value.validate()){b.value=!0;try{const t={name:v.value,email:V.value,phone:c.value,password:p.value};await T.register(t),y.value="success",f.value="Регистрация успешно завершена! Теперь вы можете войти в систему.",i.value=!0,setTimeout(()=>{U.push("/login")},2e3)}catch(t){console.error("Ошибка регистрации:",t),y.value="error",t.response&&t.response.data&&t.response.data.detail?f.value="Ошибка: "+t.response.data.detail:f.value="Произошла ошибка при регистрации. Пожалуйста, попробуйте снова.",i.value=!0}finally{b.value=!1}}};return(t,l)=>(D(),j(F,{fluid:"",class:"fill-height bg-secondary-subtle"},{default:o(()=>[a(C,{justify:"center",align:"center"},{default:o(()=>[a(s,{cols:"12",sm:"10",md:"6",lg:"5"},{default:o(()=>[a(M,{class:"elevation-5 rounded-lg"},{default:o(()=>[a(P,{class:"text-center pt-6 pb-2"},{default:o(()=>l[9]||(l[9]=[d("h4",{class:"text-h4 font-weight-bold"},"Регистрация клиента",-1)])),_:1}),a(R,null,{default:o(()=>[a(z,{ref_key:"form",ref:x,onSubmit:E(q,["prevent"])},{default:o(()=>[a(C,null,{default:o(()=>[a(s,{cols:"12"},{default:o(()=>[a(m,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=e=>v.value=e),label:"Имя",placeholder:"Введите ваше имя","prepend-inner-icon":"mdi-account",rules:[e=>!!e||"Имя обязательно"],required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(s,{cols:"12",md:"6"},{default:o(()=>[a(m,{modelValue:V.value,"onUpdate:modelValue":l[1]||(l[1]=e=>V.value=e),label:"Email",placeholder:"Введите ваш email","prepend-inner-icon":"mdi-email",rules:[e=>!!e||"Email обязателен",e=>/.+@.+\..+/.test(e)||"Email должен быть корректным"],required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(s,{cols:"12",md:"6"},{default:o(()=>[a(m,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value=e),label:"Телефон",placeholder:"Введите ваш телефон","prepend-inner-icon":"mdi-phone",rules:[e=>!!e||"Телефон обязателен"],required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(s,{cols:"12",md:"6"},{default:o(()=>[a(m,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=e=>p.value=e),label:"Пароль",placeholder:"Введите пароль","prepend-inner-icon":"mdi-lock","append-inner-icon":n.value?"mdi-eye-off":"mdi-eye",type:n.value?"text":"password","onClick:appendInner":l[4]||(l[4]=e=>n.value=!n.value),rules:[e=>!!e||"Пароль обязателен",e=>e.length>=6||"Пароль должен содержать не менее 6 символов"],required:"",variant:"outlined"},null,8,["modelValue","append-inner-icon","type","rules"])]),_:1}),a(s,{cols:"12",md:"6"},{default:o(()=>[a(m,{modelValue:k.value,"onUpdate:modelValue":l[5]||(l[5]=e=>k.value=e),label:"Подтверждение пароля",placeholder:"Подтвердите пароль","prepend-inner-icon":"mdi-lock-check",type:n.value?"text":"password",rules:[e=>!!e||"Подтверждение пароля обязательно",e=>e===p.value||"Пароли должны совпадать"],required:"",variant:"outlined"},null,8,["modelValue","type","rules"])]),_:1}),a(s,{cols:"12"},{default:o(()=>[a(A,{modelValue:w.value,"onUpdate:modelValue":l[6]||(l[6]=e=>w.value=e),color:"primary",rules:[e=>!!e||"Вы должны согласиться с условиями"],required:""},{label:o(()=>l[10]||(l[10]=[d("div",null,[u(" Я принимаю "),d("a",{href:"#",class:"text-primary"},"условия использования"),u(" и "),d("a",{href:"#",class:"text-primary"},"политику конфиденциальности")],-1)])),_:1},8,["modelValue","rules"])]),_:1})]),_:1}),a(g,{color:"primary",block:"",size:"large",type:"submit",loading:b.value,class:"mt-2 mb-4"},{default:o(()=>l[11]||(l[11]=[u(" Зарегистрироваться ")])),_:1},8,["loading"])]),_:1},512)]),_:1}),a(I),a($,{class:"pa-4 justify-center"},{default:o(()=>[l[13]||(l[13]=d("span",{class:"text-medium-emphasis"},"Уже есть аккаунт?",-1)),a(g,{variant:"text",color:"primary",to:"/login"},{default:o(()=>l[12]||(l[12]=[u(" Войти ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(K,{modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=e=>i.value=e),color:y.value,timeout:"5000"},{actions:o(()=>[a(g,{variant:"text",onClick:l[7]||(l[7]=e=>i.value=!1)},{default:o(()=>l[14]||(l[14]=[u("Закрыть")])),_:1})]),default:o(()=>[u(N(f.value)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}};export{ne as default};
