import{d as x,x as R,w as W,K as d,L as o,M as e,m as s,O as n,S as i,R as V,F as b,U as I,T as u,V as S,W as y,Z as B,Y as E,_ as H,B as O}from"./vue-vendor-B4qzxTjV.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as Z,e as L,f as $}from"./index-CIpMSW_s.js";import{V as z,a as M,b as h}from"./VCard-BaakkVFD.js";import{V as K}from"./VSpacer-CKNG9Jdn.js";import{V as N}from"./VChip-pvFqXEpf.js";import{V as q,a as G,b as J,c as P}from"./VList-zMJOwsiP.js";import{V as Q}from"./VBadge-3i7ShY3u.js";import{h as j,f as p}from"./VAvatar-C-ER2-0S.js";import{V as v}from"./VBtn-B-hdhH-1.js";import{V as X}from"./VForm-D0rJnxSg.js";import{V as ee}from"./VTextarea-8VdTHJP4.js";import"./vuetify-vendor-BD37EBPT.js";import"./index-yNQZhi3p.js";import"./VDivider-Drx-iRHJ.js";import"./VInput-Bp3p24Ap.js";import"./forwardRefs-C-GTDzx5.js";import"./VField-BmVeynRq.js";const te={class:"text-caption"},ae={class:"d-flex flex-column align-center"},se={class:"text-caption"},le={class:"text-caption"},ne={class:"text-body-1"},oe={class:"text-caption"},re={key:4,class:"pa-3 border-top"},ie={class:"d-flex align-center"},de={__name:"operator",setup(ue){const c=x([{id:1,name:"Иван Петров",lastMessage:"Добрый день, мне нужна помощь с заказом",lastMessageTime:new Date("2023-10-15T15:30:00"),unreadCount:2,status:"online"},{id:2,name:"Мария Сидорова",lastMessage:"Спасибо за информацию!",lastMessageTime:new Date("2023-10-15T14:45:00"),unreadCount:0,status:"online"},{id:3,name:"Алексей Иванов",lastMessage:"Когда будет доставка?",lastMessageTime:new Date("2023-10-15T12:20:00"),unreadCount:0,status:"offline"}]),r=x(null),m=x([]),g=x(""),C=x(!0),_=x(null);function k(l){if(!l)return"";const t=new Date,a=new Date(l);return t.toDateString()===a.toDateString()?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString()}function A(l){r.value=l,l.unreadCount=0,F(l.id)}function F(l){l===1?m.value=[{sender:"client",text:"Добрый день! Мне нужна помощь с заказом №12345",time:new Date("2023-10-15T15:25:00")},{sender:"client",text:'Я его оплатил, но статус до сих пор "в обработке"',time:new Date("2023-10-15T15:30:00")}]:l===2?m.value=[{sender:"client",text:"Здравствуйте, подскажите, как вернуть товар?",time:new Date("2023-10-15T14:30:00")},{sender:"operator",text:"Добрый день! Для возврата товара вам необходимо заполнить заявление на возврат в личном кабинете.",time:new Date("2023-10-15T14:35:00")},{sender:"client",text:"Спасибо за информацию!",time:new Date("2023-10-15T14:45:00")}]:l===3?m.value=[{sender:"client",text:"Добрый день! Когда будет доставка моего заказа №67890?",time:new Date("2023-10-15T12:15:00")},{sender:"operator",text:"Добрый день! Ваш заказ будет доставлен завтра с 10:00 до 18:00.",time:new Date("2023-10-15T12:18:00")},{sender:"client",text:"Когда будет доставка?",time:new Date("2023-10-15T12:20:00")}]:m.value=[],w()}function T(){if(!g.value.trim()||!r.value)return;const l={sender:"operator",text:g.value.trim(),time:new Date};m.value.push(l);const t=c.value.findIndex(a=>a.id===r.value.id);t!==-1&&(c.value[t].lastMessage=l.text,c.value[t].lastMessageTime=l.time),g.value="",w()}async function w(){await O(),_.value&&(_.value.scrollTop=_.value.scrollHeight)}function U(){C.value=!0;const l=setInterval(()=>{if(r.value&&Math.random()>.7){const t=["У меня возник еще один вопрос...","Спасибо за помощь!","Когда будет готово?","Не могли бы вы уточнить детали?"],a={sender:"client",text:t[Math.floor(Math.random()*t.length)],time:new Date};m.value.push(a);const f=c.value.findIndex(D=>D.id===r.value.id);f!==-1&&(c.value[f].lastMessage=a.text,c.value[f].lastMessageTime=a.time),w()}},3e4);H(()=>{clearInterval(l)})}return R(()=>{U()}),W(m,()=>{w()}),(l,t)=>(o(),d($,{fluid:"",class:"pa-0 fill-height"},{default:e(()=>[s(Z,{"no-gutters":"",class:"fill-height"},{default:e(()=>[s(L,{cols:"3",class:"border-right"},{default:e(()=>[s(z,{flat:"",height:"100%"},{default:e(()=>[s(M,{class:"d-flex align-center"},{default:e(()=>[t[3]||(t[3]=n("span",null,"Клиенты",-1)),s(K),C.value?(o(),d(N,{key:0,color:"success",size:"small"},{default:e(()=>t[1]||(t[1]=[i(" Онлайн ")])),_:1})):(o(),d(N,{key:1,color:"error",size:"small"},{default:e(()=>t[2]||(t[2]=[i(" Офлайн ")])),_:1}))]),_:1}),s(h,{class:"pa-0"},{default:e(()=>[s(q,null,{default:e(()=>[(o(!0),V(b,null,I(c.value,a=>{var f;return o(),d(G,{key:a.id,active:((f=r.value)==null?void 0:f.id)===a.id,onClick:D=>A(a)},{prepend:e(()=>[s(j,{color:"grey lighten-1",size:"36"},{default:e(()=>[n("span",te,u(a.name.charAt(0)),1)]),_:2},1024)]),append:e(()=>[n("div",ae,[n("span",se,u(k(a.lastMessageTime)),1),a.unreadCount>0?(o(),d(Q,{key:0,content:a.unreadCount,color:"error",floating:""},null,8,["content"])):S("",!0)])]),default:e(()=>[s(J,null,{default:e(()=>[i(u(a.name),1)]),_:2},1024),s(P,null,{default:e(()=>[i(u(a.lastMessage),1)]),_:2},1024)]),_:2},1032,["active","onClick"])}),128))]),_:1})]),_:1})]),_:1})]),_:1}),s(L,{cols:"9"},{default:e(()=>[s(z,{flat:"",height:"100%",class:"d-flex flex-column"},{default:e(()=>[r.value?(o(),d(M,{key:0,class:"border-bottom d-flex align-center"},{default:e(()=>[s(j,{color:"grey lighten-1",size:"36",class:"mr-3"},{default:e(()=>[n("span",le,u(r.value.name.charAt(0)),1)]),_:1}),n("div",null,[n("div",ne,u(r.value.name),1),n("div",oe,u(r.value.status),1)]),s(K),s(v,{icon:""},{default:e(()=>[s(p,null,{default:e(()=>t[4]||(t[4]=[i("mdi-phone")])),_:1})]),_:1}),s(v,{icon:""},{default:e(()=>[s(p,null,{default:e(()=>t[5]||(t[5]=[i("mdi-video")])),_:1})]),_:1}),s(v,{icon:""},{default:e(()=>[s(p,null,{default:e(()=>t[6]||(t[6]=[i("mdi-information-outline")])),_:1})]),_:1}),s(v,{icon:""},{default:e(()=>[s(p,null,{default:e(()=>t[7]||(t[7]=[i("mdi-dots-vertical")])),_:1})]),_:1})]),_:1})):(o(),d(M,{key:1,class:"border-bottom d-flex align-center"},{default:e(()=>t[8]||(t[8]=[n("div",null,"Выберите клиента для начала общения",-1)])),_:1})),r.value?(o(),d(h,{key:2,class:"flex-grow-1 overflow-auto pa-4",ref_key:"chatMessages",ref:_},{default:e(()=>[(o(!0),V(b,null,I(m.value,(a,f)=>(o(),V("div",{key:f,class:y(["mb-4",{"d-flex justify-end":a.sender==="operator","d-flex justify-start":a.sender==="client"}])},[n("div",{class:y(["message-bubble pa-3 rounded",{primary:a.sender==="operator","bg-grey-lighten-3":a.sender==="client"}]),style:{"max-width":"80%"}},[n("div",{class:y({"text-white":a.sender==="operator"})},u(a.text),3),n("div",{class:y(["text-caption mt-1 text-right",{"text-white":a.sender==="operator"}])},u(k(a.time)),3)],2)],2))),128))]),_:1},512)):(o(),d(h,{key:3,class:"flex-grow-1 d-flex align-center justify-center"},{default:e(()=>t[9]||(t[9]=[n("div",{class:"text-h6 text-grey-darken-1"}," Выберите клиента из списка слева для начала общения ",-1)])),_:1})),r.value?(o(),V("div",re,[s(X,{onSubmit:B(T,["prevent"])},{default:e(()=>[n("div",ie,[s(v,{icon:"",class:"mr-2"},{default:e(()=>[s(p,null,{default:e(()=>t[10]||(t[10]=[i("mdi-emoticon-outline")])),_:1})]),_:1}),s(v,{icon:"",class:"mr-2"},{default:e(()=>[s(p,null,{default:e(()=>t[11]||(t[11]=[i("mdi-paperclip")])),_:1})]),_:1}),s(ee,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),placeholder:"Введите сообщение...",rows:"1","auto-grow":"","hide-details":"",density:"compact",class:"flex-grow-1",onKeydown:E(B(T,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),s(v,{icon:"",class:"ml-2",color:"primary",onClick:T,disabled:!g.value.trim()},{default:e(()=>[s(p,null,{default:e(()=>t[12]||(t[12]=[i("mdi-send")])),_:1})]),_:1},8,["disabled"])])]),_:1})])):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},Ie=Y(de,[["__scopeId","data-v-7c2a68dc"]]);export{Ie as default};
